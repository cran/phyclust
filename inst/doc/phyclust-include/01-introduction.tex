
\section[Introduction]{Introduction}
\label{sec:introduction}
\addcontentsline{toc}{section}{\thesection. Introduction}

{\bf Warning.} This document is written to explain the major functions of \pkg{phyclust}, version 0.1-4.
Every effort will be made to insure future versions are consistent with these instructions, but new features in later versions may not be explained in this document.

This is a quick guide to the package \pkg{phyclust}.
We will cover how to read and write sequence data,
how to use the popular programs \code{ms}~\citep{Hudson2002} and \code{seq-gen}~\citep{Rambaut1997} for generating
coalescent trees and molecular sequences from within \pkg{phyclust},
the main function \code{phyclust()} for finding population structure,
and Haplo-Clustering \citep{tzeng2005}.
More information about the theory, other package functions,
and any changes in future versions can be found on our website
Phylogenetic Clustering at
\url{http://thirteen-01.stat.iastate.edu/snoweye/phyclust/}.

Specifically, in Section~\ref{sec:dataio}, we introduce the basic data structures
of \pkg{phyclust} and the I/O functions for reading and writing 
PHYLIP and FASTA files. In Section~\ref{sec:msseqgen},
we demonstrate how to simulate molecular data using the ``ms+seqgen'' approach from within \proglang{R}.
In Section~\ref{sec:phyloclustering}, we briefly describe
the phylogenetic clustering method, its implementation in \code{phyclust()}, the visualization functions,
the auxiliary function \code{.EMControl()} for choosing the model, initialization method, optimization method,
and the EM algorithm variant, and propose a ``ms+seqgen+phyclust'' approach.
In Section~\ref{sec:haplo}, we demonstrate the function
\code{haplo.post.prob()} for Hap-Clustering.




\subsection[Installation and quick start]{Installation and quick start}
\label{sec:installation}
\addcontentsline{toc}{subsection}{\thesubsection. Installation and quick start}

You can install directly from CRAN at \url{http://cran.r-project.org} or
download the \pkg{phyclust} from our website.
On most systems, you can install \pkg{phyclust} by typing the following command
into \proglang{R}'s terminal:
\begin{Code}
> install.packages("phyclust")
\end{Code}
When it finishes, you can use \code{library()} to load the package as
\begin{Code}
> library("phyclust")
\end{Code}
Note that \pkg{phyclust} requires \pkg{ape} package \citep{Paradis2004}, and
the \pkg{ape} also requires other packages depending on its version.
All the required packages will be checked and automatically loaded when
the \pkg{phyclust} is loading.

You can get started quickly with \pkg{phyclust} by using the \code{demo()} command
in \proglang{R}.
\begin{Code}
> demo("toy", package = "phyclust")
\end{Code}
This demo will produce the three plots shown in Figures~\ref{fig:toydots},
\ref{fig:toyhist} and \ref{fig:toynj}, and some of the results reported in
the Section~\ref{sec:emcontrol}.
This demonstration does the same as the followings, see the next
few section for more details.
\begin{Code}
### Rename the data and obtain classification.
  X <- seq.data.toy$org
  X.class <- as.numeric(gsub(".*-(.)", "\\1", seq.data.toy$seqname))
### A dot plot, Figure 2.
  windows()
  plotdots(X, X.class)
### A histogram plot, Figure 3.
  windows()
  plothist(X, X.class)
### A Neighbor-Joining plot, Figure 4.
  ret <- phyclust.edist(X, edist.model = .edist.model[3])
  ret.tree <- nj(ret)
  windows()
  plotnj(ret.tree, X.class = X.class)
### Fit a EE, JC69 model using emEM, Section ``Use the .EMControl() function''.
  EMC.2 <- .EMControl(init.procedure = "emEM")
  set.seed(1234)
  (ret.2 <- phyclust(X, 4, EMC = EMC.2))
  RRand(ret.2$class.id, X.class)
\end{Code}



\subsection[Getting help]{Getting help}
\label{sec:needhelp}
\addcontentsline{toc}{subsection}{\thesubsection. Getting help \vspace{-0.3cm}}

You can look for more examples on the help pages or our
website:
\url{http://thirteen-01.stat.iastate.edu/snoweye/phyclust/}.
Also, you can email the author at \email{phyclust@gmail.com}.
All comments are welcome.  Bugs will be fixed and
suggestions may be implemented in future versions of \pkg{phyclust}.

